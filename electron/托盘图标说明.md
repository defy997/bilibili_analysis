# 系统托盘功能说明

## ✅ 已实现功能

### 窗口控制
- **Minimize（最小化）** → 隐藏到系统托盘
- **Close（关闭）** → 直接退出应用

### 托盘菜单
右键点击托盘图标，可以看到：
- 显示 BiliMood
- 隐藏
- 退出

### 托盘图标交互
- 左键点击托盘图标 → 切换窗口显示/隐藏

---

## 🎨 自定义托盘图标

### 方法1：使用自己的图标（推荐）

1. **准备图标文件**
   - 格式：PNG（推荐）或 ICO
   - 尺寸：32x32 或 16x16 像素
   - 名称：`tray-icon.png`

2. **放置图标**
   ```
   electron/
   └── assets/
       └── tray-icon.png  ← 把图标放这里
   ```

3. **重启应用**
   - 应用会自动使用新图标

### 方法2：在线生成图标

推荐的在线工具：
- [Favicon.io](https://favicon.io/) - 文字转图标
- [Icons8](https://icons8.com/) - 免费图标库
- [Flaticon](https://www.flaticon.com/) - 海量图标

#### 生成步骤：
1. 访问 [Favicon.io](https://favicon.io/favicon-generator/)
2. 设置参数：
   - Text: BM 或 ♥
   - Background: #ec4899 (粉色)
   - Font Family: Righteous
   - Font Size: 80
3. 下载图标
4. 重命名为 `tray-icon.png`
5. 放到 `electron/assets/` 目录

### 方法3：使用 Emoji（简单）

如果你想用 emoji 作为图标：

```javascript
// 在 main.js 的 createTray() 函数中修改：
const icon = nativeImage.createFromDataURL(
  'data:image/svg+xml;base64,' +
  Buffer.from(`
    <svg width="32" height="32" xmlns="http://www.w3.org/2000/svg">
      <text x="16" y="24" font-size="24" text-anchor="middle">💖</text>
    </svg>
  `).toString('base64')
);
```

---

## 📝 图标设计建议

### BiliMood 风格
- **主色调：** 粉色 (#ec4899, #f472b6)
- **辅助色：** 白色、浅灰
- **元素：**
  - B站 Logo 的粉色
  - 心形图标 ♥
  - 情感符号（笑脸、哭脸等）

### 推荐设计
```
╔══════════════╗
║   [B]  ♥     ║  ← B站标志 + 粉色心形
╚══════════════╝

或

╔══════════════╗
║      💖      ║  ← 简单的粉色心形 emoji
╚══════════════╝
```

### 尺寸要求
- **Windows：** 16x16 或 32x32 像素
- **macOS：** 16x16（Retina: 32x32）
- **Linux：** 22x22 或 24x24

---

## 🔧 高级配置

### 动态图标（可选）

可以根据状态切换图标：

```javascript
// 在 main.js 中添加
function updateTrayIcon(status) {
  let iconPath;
  switch(status) {
    case 'analyzing':
      iconPath = path.join(__dirname, 'assets', 'tray-analyzing.png');
      break;
    case 'idle':
      iconPath = path.join(__dirname, 'assets', 'tray-idle.png');
      break;
    default:
      iconPath = path.join(__dirname, 'assets', 'tray-icon.png');
  }

  const icon = nativeImage.createFromPath(iconPath);
  if (tray && !icon.isEmpty()) {
    tray.setImage(icon);
  }
}
```

### 托盘闪烁提示（可选）

当有新分析结果时：

```javascript
let flashInterval;

function startFlashing() {
  let isHighlighted = false;
  flashInterval = setInterval(() => {
    tray.setHighlightMode(isHighlighted ? 'never' : 'always');
    isHighlighted = !isHighlighted;
  }, 500);
}

function stopFlashing() {
  if (flashInterval) {
    clearInterval(flashInterval);
    tray.setHighlightMode('never');
  }
}
```

---

## 📦 当前图标

目前使用的是内置的粉色心形图标（base64 编码）。

如果你想替换成自己的图标，只需：
1. 创建 `electron/assets/` 目录
2. 放入 `tray-icon.png` 文件（32x32像素）
3. 重启应用

---

## 🐛 常见问题

### Q: 图标显示模糊？
**A:** 确保使用正确的尺寸（32x32 或 16x16）。避免使用过大或过小的图标。

### Q: 图标不显示？
**A:** 检查：
1. 文件路径是否正确
2. 文件格式是否支持（PNG/ICO）
3. 文件是否损坏

### Q: 托盘菜单显示乱码？
**A:** 确保代码文件使用 UTF-8 编码。

---

最后更新：2026-01-29
